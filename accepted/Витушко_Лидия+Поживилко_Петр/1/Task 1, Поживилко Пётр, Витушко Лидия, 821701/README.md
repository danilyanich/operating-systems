# МАТЕМАТИЧЕСКИЕ ОСНОВЫ РЕЛЯЦИОННЫХ ЯЗЫКОВ

## Реализация менеджера памяти с сегментным разбиением


Содержание репозитория:

Функция                                | Назначение
---------------------------------------|----------------------
m_init                                 | Выделение памяти для работы менеджера
m_malloc                               | Выделение памяти для одного сегмента
m_write                                | Записывает массив символов в сегмент
m_read                                 | Читает массив символов из сегмента
m_free                                 | Освобождает память, выделенную под сегмент

### Подробное описание принципа работы функций

#### m_init

Если у нас прежде была выделена память, она освобождается, а затем снова выделяется. 

#### m_malloc

Сначала идет проверка. Если общее кол-во выделенных байт + размер выделяемого сегмента больше общего размера, выдается ошибка M_ERR_ALLOCATION_OUT_OF_MEMORY.
Если нет - мы выделяем память под наш сегмент. Если в нашем списке нет элементов, то наш сегмент указывает на _g_allocator_memory+_g_bytes_allocated. Указатель нашей структуры указывает на смещение от начала массива. 
Размер нашего сегмента равен размеру выделенной памяти. Указатель на следующий элемент равен NULL. Указатель на начало списка указывает на выделенный сегмент. 
Если есть элементы, то мы просто идем до конца списка и делаем то же самое. Увеличиваем переменную, хранящую количество уже выделенных байт.

#### m_write и m_read

Сначала идет проверка на корректность входных данных, затем для m_read кусок массива, который хранится в сегмента, загружается в буфер, для m_write - буфер загружается в сегмент.

#### m_free

Сначала идет проверка: был ли сегмент удален. Затем идет проверка является ли удаляемый сегмент первым в списке. Если да, то начало списка меняется на следующий элемент и очищается память по переданному указателю. Иначе из списка выбрасывается удаляемый элемент, по его адресу очищается память и массивы памяти перезаписывается от начала до конца.